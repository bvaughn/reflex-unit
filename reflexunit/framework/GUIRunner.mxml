<?xml version="1.0" encoding="utf-8"?>
<mx:Grid width="100%" height="100%"
         initialize="onInitialize( event )"
         implements="reflexunit.framework.IResultViewer"
         xmlns:mx="http://www.adobe.com/2006/mxml">
	
	<mx:Script>
		<![CDATA[
			import flash.utils.getQualifiedClassName;
			
			import reflexunit.framework.runners.GUIRunnerController;
			import reflexunit.introspection.model.MethodModel;
			
			import mx.collections.ArrayCollection;
			import mx.controls.dataGridClasses.DataGridColumn;
			import mx.events.FlexEvent;
			
			/*
			 * Variables
			 */
			
			/**
			 * Collectin of <code>IStatus</code> objects contained in the <code>Result</code> generated by running this class.
			 */
			[Bindable]
			public var dataProvider:ArrayCollection = new ArrayCollection();
			
			private var _controller:GUIRunnerController
			
			/*
			 * Initialization
			 */
			
			private function onInitialize( event:FlexEvent ):void {
				controller.initialize();
			}
			
			/**
			 * @inheritDoc
			 */
			public function allTestsCompleted():void {
				controller.allTestsCompleted();
			}
			
			/**
			 * @inheritDoc
			 */
			public function testCompleted( methodModel:MethodModel ):void {
				controller.testCompleted( methodModel );
			}
			
			/**
			 * @inheritDoc
			 */
			public function testStarting( methodModel:MethodModel ):void {
				controller.testStarting( methodModel );
			}
			
			/*
			 * Getter / setter methods
			 */
			
			private function get controller():GUIRunnerController {
				if ( _controller == null ) {
					_controller = new GUIRunnerController( this );
				}
				
				return _controller;
			}
			
			/**
			 * @inheritDoc
			 */
			public function set result( value:Result ):void {
				controller.result = value;
			}
			
			/**
			 * @inheritDoc
			 */
			public function set test( value:ITest ):void {
				controller.test = value;
			}
		]]>
	</mx:Script>
	
	<mx:GridRow width="100%" height="100%">
		<mx:GridItem width="100%">
			<mx:DataGrid id="dataGrid" horizontalCenter="0" width="100%" height="100%"
			             dataProvider="{ dataProvider }">
				
				<mx:columns>
					<mx:DataGridColumn headerText="Test Case" labelFunction="{ GUIRunnerController.getTestCaseName }" />
					<mx:DataGridColumn headerText="Test" labelFunction="{ GUIRunnerController.getTestName }" />
					<!-- TODO
					<mx:DataGridColumn headerText="Time" />
					-->
					<mx:DataGridColumn headerText="Status" dataField="status" />
					<mx:DataGridColumn headerText="Message" labelFunction="{ GUIRunnerController.getMessage }" />
				</mx:columns>
			</mx:DataGrid>
		</mx:GridItem>
	</mx:GridRow>
	
</mx:Grid>